@model List<UserWithFriendsCountVM>
<div class="flex items-baseline justify-between">
    <h3 class="font-bold text-[#4a3256]"> People you may know </h3>
</div>
<div class="space-y-4 mt-3">
    @foreach (var user in Model)
    {
        <div class="flex items-center gap-3">
            <a asp-controller="User" asp-action="Details" asp-route-userId="@user.UserId">
                <img src="@Url.Content("~/" + (string.IsNullOrEmpty(user.ProfilePictureUrl) ? "images/avatar/User.png" : user.ProfilePictureUrl))" class="w-10 h-10 rounded-full border border-[#cabeca]" />
            </a>
            <div class="flex-1">
                <a asp-controller="User" asp-action="Details" asp-route-userId="@user.UserId">
                    <h4 class="font-medium text-[#4a3256]">@user.FullName</h4>
                </a>
                <div class="text-xs text-[#cabeca]">@user.FriendsCountText</div>
            </div>

            @if (user.PendingFriendRequest == null)
            {
                <form asp-controller="Friends" asp-action="SendRequest">
                    <input type="hidden" name="receiverId" value="@user.UserId" />
                    <button type="submit" class="add-friend-btn bg-[#4a3256] hover:bg-opacity-90 transition-all ease-in-out duration-200 text-xs text-white rounded-full cursor-pointer px-3 py-1.5">
                        <ion-icon name="person-add-outline" class="mr-1"></ion-icon>
                        Add Friend
                    </button>
                </form>
            }
            else if (user.HasSentRequest)
            {
                <form asp-controller="Friends" asp-action="UpdateRequest">
                    <input type="hidden" name="status" value="@FriendRequestStatus.Cancelled" />
                    <input type="hidden" name="requestId" value="@user.PendingFriendRequest.Id" />
                    <button type="submit" class="friend-request-btn bg-gray-200 hover:bg-gray-300 transition-all ease-in-out duration-200 text-xs text-[#4a3256] rounded-full cursor-pointer px-3 py-1.5">
                        Cancel
                    </button>
                </form>
            }
            else
            {
                <div class="flex items-center gap-2">
                    <form asp-controller="Friends" asp-action="UpdateRequest">
                        <input type="hidden" name="status" value="@FriendRequestStatus.Accepted" />
                        <input type="hidden" name="requestId" value="@user.PendingFriendRequest.Id" />
                        <button type="submit" class="friend-request-btn bg-[#4a3256] hover:bg-opacity-90 transition-all ease-in-out duration-200 text-xs text-white rounded-full cursor-pointer px-3 py-1.5">
                            Accept
                        </button>
                    </form>
                    <form asp-controller="Friends" asp-action="UpdateRequest">
                        <input type="hidden" name="status" value="@FriendRequestStatus.Rejected" />
                        <input type="hidden" name="requestId" value="@user.PendingFriendRequest.Id" />
                        <button type="submit" class="friend-request-btn bg-gray-200 hover:bg-gray-300 transition-all ease-in-out duration-200 text-xs text-[#4a3256] rounded-full cursor-pointer px-3 py-1.5">
                            Reject
                        </button>
                    </form>
                </div>
            }
        </div>
    }
</div>
